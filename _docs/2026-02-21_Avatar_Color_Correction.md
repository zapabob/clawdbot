# Avatar Color Correction

## 日時

2026-02-21

## 実装内容

- **アバターの顔面真っ白問題の修正**:
  - `scripts/avatar-window.html` 内の FBXLoader にて生成されるマテリアル（`MeshToonMaterial`）の処理を見直しました。
  - テクスチャが存在する場合に強制的に `baseColor` を真っ白 (`0xffffff`) にしていた部分を、FBX の元々の `mat.color` を参照するように修正しました（テクスチャがエクスポート時に黒になっているケースの対策も追加）。
  - さらに、アニメーション風により元のテクスチャが発光して見えるように誤って適用されていた `emissiveMap = mat.map` の処理を削除し、純粋な陰影で toon レンダリングされるように修正しました。
  - アニメ風の陰影を強調するため、色の彩度 (Saturation) をプログラム側で約1.5倍に引き上げ、明度 (Lightness) を適度に調整する処理を追加しました。
- **照明（ライト）の調整**:
  - `AmbientLight` と `DirectionalLight` をそれぞれ `0.5` に設定し、顔や体の正面に当たる光の合計強度がちょうど `1.0` を超えないように（白飛びしないように）微調整しました。

## 結果

- キャラクターの顔が白飛びせず、FBX本来のテクスチャ色を反映した鮮やかなアニメ調のアバターレンダリングが実現されました。
